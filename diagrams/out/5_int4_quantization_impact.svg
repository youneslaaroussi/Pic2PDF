<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.1 (20251006.0113)
 -->
<!-- Pages: 1 -->
<svg width="1353pt" height="895pt"
 viewBox="0.00 0.00 1353.00 895.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 891)">
<polygon fill="white" stroke="none" points="-4,4 -4,-891 1348.5,-891 1348.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_fp16</title>
<path fill="#ffe6e6" stroke="black" d="M15,-504C15,-504 148.75,-504 148.75,-504 154.75,-504 160.75,-510 160.75,-516 160.75,-516 160.75,-867 160.75,-867 160.75,-873 154.75,-879 148.75,-879 148.75,-879 15,-879 15,-879 9,-879 3,-873 3,-867 3,-867 3,-516 3,-516 3,-510 9,-504 15,-504"/>
<text xml:space="preserve" text-anchor="middle" x="81.88" y="-863.6" font-family="Comic Sans MS" font-size="12.00">FP16 Baseline (Not Used)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_int4</title>
<path fill="#e6ffe6" stroke="black" d="M742.38,-138C742.38,-138 1088.5,-138 1088.5,-138 1094.5,-138 1100.5,-144 1100.5,-150 1100.5,-150 1100.5,-371 1100.5,-371 1100.5,-377 1094.5,-383 1088.5,-383 1088.5,-383 742.38,-383 742.38,-383 736.38,-383 730.38,-377 730.38,-371 730.38,-371 730.38,-150 730.38,-150 730.38,-144 736.38,-138 742.38,-138"/>
<text xml:space="preserve" text-anchor="middle" x="915.44" y="-367.6" font-family="Comic Sans MS" font-size="12.00">INT4 Quantized (Actual)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_quant</title>
<path fill="#fff8dc" stroke="black" d="M357,-391C357,-391 850.5,-391 850.5,-391 856.5,-391 862.5,-397 862.5,-403 862.5,-403 862.5,-591 862.5,-591 862.5,-597 856.5,-603 850.5,-603 850.5,-603 357,-603 357,-603 351,-603 345,-597 345,-591 345,-591 345,-403 345,-403 345,-397 351,-391 357,-391"/>
<text xml:space="preserve" text-anchor="middle" x="603.75" y="-587.6" font-family="Comic Sans MS" font-size="12.00">Quantization Process</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_benefits</title>
<path fill="#e6f3ff" stroke="black" d="M1205.5,-8C1205.5,-8 1324.5,-8 1324.5,-8 1330.5,-8 1336.5,-14 1336.5,-20 1336.5,-20 1336.5,-355 1336.5,-355 1336.5,-361 1330.5,-367 1324.5,-367 1324.5,-367 1205.5,-367 1205.5,-367 1199.5,-367 1193.5,-361 1193.5,-355 1193.5,-355 1193.5,-20 1193.5,-20 1193.5,-14 1199.5,-8 1205.5,-8"/>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-351.6" font-family="Comic Sans MS" font-size="12.00">ARM64 Benefits</text>
</g>
<!-- fp16_model -->
<g id="node1" class="node">
<title>fp16_model</title>
<path fill="#ffb6c1" stroke="black" d="M113.75,-586C113.75,-586 49,-586 49,-586 43,-586 37,-580 37,-574 37,-574 37,-524 37,-524 37,-518 43,-512 49,-512 49,-512 113.75,-512 113.75,-512 119.75,-512 125.75,-518 125.75,-524 125.75,-524 125.75,-574 125.75,-574 125.75,-580 119.75,-586 113.75,-586"/>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-571.55" font-family="Comic Sans MS" font-size="11.00">Gemma 2B</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-555.05" font-family="Comic Sans MS" font-size="11.00">FP16 weights</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-538.55" font-family="Comic Sans MS" font-size="11.00">~4GB on disk</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-522.05" font-family="Comic Sans MS" font-size="11.00">16 bits/param</text>
</g>
<!-- int4_model -->
<g id="node4" class="node">
<title>int4_model</title>
<path fill="#90ee90" stroke="black" d="M820.75,-350C820.75,-350 757.5,-350 757.5,-350 751.5,-350 745.5,-344 745.5,-338 745.5,-338 745.5,-288 745.5,-288 745.5,-282 751.5,-276 757.5,-276 757.5,-276 820.75,-276 820.75,-276 826.75,-276 832.75,-282 832.75,-288 832.75,-288 832.75,-338 832.75,-338 832.75,-344 826.75,-350 820.75,-350"/>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-335.55" font-family="Comic Sans MS" font-size="11.00">Gemma 2B</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-319.05" font-family="Comic Sans MS" font-size="11.00">INT4 weights</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-302.55" font-family="Comic Sans MS" font-size="11.00">~1GB on disk</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-286.05" font-family="Comic Sans MS" font-size="11.00">4 bits/param</text>
</g>
<!-- fp16_model&#45;&gt;int4_model -->
<g id="edge10" class="edge">
<title>fp16_model&#45;&gt;int4_model</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M81.5,-511.61C81.5,-445.06 81.5,-313 81.5,-313 81.5,-313 733.61,-313 733.61,-313"/>
<polygon fill="blue" stroke="blue" points="733.61,-316.5 743.61,-313 733.61,-309.5 733.61,-316.5"/>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-718.75" font-family="Comic Sans MS" font-size="10.00">4× compression</text>
</g>
<!-- scale -->
<g id="node7" class="node">
<title>scale</title>
<path fill="#fafad2" stroke="black" d="M524.25,-569.5C524.25,-569.5 365,-569.5 365,-569.5 359,-569.5 353,-563.5 353,-557.5 353,-557.5 353,-540.5 353,-540.5 353,-534.5 359,-528.5 365,-528.5 365,-528.5 524.25,-528.5 524.25,-528.5 530.25,-528.5 536.25,-534.5 536.25,-540.5 536.25,-540.5 536.25,-557.5 536.25,-557.5 536.25,-563.5 530.25,-569.5 524.25,-569.5"/>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-555.05" font-family="Comic Sans MS" font-size="11.00">Per&#45;channel scaling</text>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-538.55" font-family="Comic Sans MS" font-size="11.00">W_int4 = round(W_fp16 / scale)</text>
</g>
<!-- fp16_model&#45;&gt;scale -->
<g id="edge1" class="edge">
<title>fp16_model&#45;&gt;scale</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M125.92,-549C125.92,-549 341.11,-549 341.11,-549"/>
<polygon fill="black" stroke="black" points="341.11,-552.5 351.11,-549 341.11,-545.5 341.11,-552.5"/>
<text xml:space="preserve" text-anchor="middle" x="252.88" y="-553.75" font-family="Comic Sans MS" font-size="10.00">offline quantization</text>
</g>
<!-- fp16_mem -->
<g id="node2" class="node">
<title>fp16_mem</title>
<path fill="#ffb6c1" stroke="black" d="M134.75,-715.75C134.75,-715.75 28,-715.75 28,-715.75 22,-715.75 16,-709.75 16,-703.75 16,-703.75 16,-670.25 16,-670.25 16,-664.25 22,-658.25 28,-658.25 28,-658.25 134.75,-658.25 134.75,-658.25 140.75,-658.25 146.75,-664.25 146.75,-670.25 146.75,-670.25 146.75,-703.75 146.75,-703.75 146.75,-709.75 140.75,-715.75 134.75,-715.75"/>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-701.3" font-family="Comic Sans MS" font-size="11.00">Runtime Memory</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-684.8" font-family="Comic Sans MS" font-size="11.00">~5&#45;6GB RAM</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-668.3" font-family="Comic Sans MS" font-size="11.00">(weights + activations)</text>
</g>
<!-- int4_mem -->
<g id="node5" class="node">
<title>int4_mem</title>
<path fill="#90ee90" stroke="black" d="M827.88,-203.75C827.88,-203.75 750.38,-203.75 750.38,-203.75 744.38,-203.75 738.38,-197.75 738.38,-191.75 738.38,-191.75 738.38,-158.25 738.38,-158.25 738.38,-152.25 744.38,-146.25 750.38,-146.25 750.38,-146.25 827.88,-146.25 827.88,-146.25 833.88,-146.25 839.88,-152.25 839.88,-158.25 839.88,-158.25 839.88,-191.75 839.88,-191.75 839.88,-197.75 833.88,-203.75 827.88,-203.75"/>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-189.3" font-family="Comic Sans MS" font-size="11.00">Runtime Memory</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-172.8" font-family="Comic Sans MS" font-size="11.00">~1.5&#45;2GB RAM</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-156.3" font-family="Comic Sans MS" font-size="11.00">4× reduction</text>
</g>
<!-- fp16_mem&#45;&gt;int4_mem -->
<g id="edge11" class="edge">
<title>fp16_mem&#45;&gt;int4_mem</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M136.5,-658.01C136.5,-549.7 136.5,-175 136.5,-175 136.5,-175 726.4,-175 726.4,-175"/>
<polygon fill="blue" stroke="blue" points="726.4,-178.5 736.4,-175 726.4,-171.5 726.4,-178.5"/>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-266.75" font-family="Comic Sans MS" font-size="10.00">4× RAM reduction</text>
</g>
<!-- fp16_perf -->
<g id="node3" class="node">
<title>fp16_perf</title>
<path fill="#ffb6c1" stroke="black" d="M111.5,-845.75C111.5,-845.75 51.25,-845.75 51.25,-845.75 45.25,-845.75 39.25,-839.75 39.25,-833.75 39.25,-833.75 39.25,-800.25 39.25,-800.25 39.25,-794.25 45.25,-788.25 51.25,-788.25 51.25,-788.25 111.5,-788.25 111.5,-788.25 117.5,-788.25 123.5,-794.25 123.5,-800.25 123.5,-800.25 123.5,-833.75 123.5,-833.75 123.5,-839.75 117.5,-845.75 111.5,-845.75"/>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-831.3" font-family="Comic Sans MS" font-size="11.00">Performance</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-814.8" font-family="Comic Sans MS" font-size="11.00">~15 tok/s</text>
<text xml:space="preserve" text-anchor="middle" x="81.38" y="-798.3" font-family="Comic Sans MS" font-size="11.00">iPhone 15 Pro</text>
</g>
<!-- int4_perf -->
<g id="node6" class="node">
<title>int4_perf</title>
<path fill="#90ee90" stroke="black" d="M1080.5,-341.75C1080.5,-341.75 1018.75,-341.75 1018.75,-341.75 1012.75,-341.75 1006.75,-335.75 1006.75,-329.75 1006.75,-329.75 1006.75,-296.25 1006.75,-296.25 1006.75,-290.25 1012.75,-284.25 1018.75,-284.25 1018.75,-284.25 1080.5,-284.25 1080.5,-284.25 1086.5,-284.25 1092.5,-290.25 1092.5,-296.25 1092.5,-296.25 1092.5,-329.75 1092.5,-329.75 1092.5,-335.75 1086.5,-341.75 1080.5,-341.75"/>
<text xml:space="preserve" text-anchor="middle" x="1049.62" y="-327.3" font-family="Comic Sans MS" font-size="11.00">Performance</text>
<text xml:space="preserve" text-anchor="middle" x="1049.62" y="-310.8" font-family="Comic Sans MS" font-size="11.00">~40&#45;50 tok/s</text>
<text xml:space="preserve" text-anchor="middle" x="1049.62" y="-294.3" font-family="Comic Sans MS" font-size="11.00">iPhone 15 Pro</text>
</g>
<!-- fp16_perf&#45;&gt;int4_perf -->
<g id="edge12" class="edge">
<title>fp16_perf&#45;&gt;int4_perf</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M123.91,-817C310.76,-817 1049.5,-817 1049.5,-817 1049.5,-817 1049.5,-353.42 1049.5,-353.42"/>
<polygon fill="blue" stroke="blue" points="1053,-353.42 1049.5,-343.42 1046,-353.42 1053,-353.42"/>
<text xml:space="preserve" text-anchor="middle" x="630" y="-21.75" font-family="Comic Sans MS" font-size="10.00">3× speedup</text>
</g>
<!-- runtime -->
<g id="node9" class="node">
<title>runtime</title>
<path fill="#fafad2" stroke="black" d="M504,-456.75C504,-456.75 385.25,-456.75 385.25,-456.75 379.25,-456.75 373.25,-450.75 373.25,-444.75 373.25,-444.75 373.25,-411.25 373.25,-411.25 373.25,-405.25 379.25,-399.25 385.25,-399.25 385.25,-399.25 504,-399.25 504,-399.25 510,-399.25 516,-405.25 516,-411.25 516,-411.25 516,-444.75 516,-444.75 516,-450.75 510,-456.75 504,-456.75"/>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-442.3" font-family="Comic Sans MS" font-size="11.00">Runtime dequantization</text>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-425.8" font-family="Comic Sans MS" font-size="11.00">INT4 → FP16 on&#45;the&#45;fly</text>
<text xml:space="preserve" text-anchor="middle" x="444.62" y="-409.3" font-family="Comic Sans MS" font-size="11.00">Cached in L1</text>
</g>
<!-- int4_model&#45;&gt;runtime -->
<g id="edge4" class="edge">
<title>int4_model&#45;&gt;runtime</title>
<path fill="none" stroke="black" d="M774.5,-350.38C774.5,-387.08 774.5,-437.58 774.5,-437.58 774.5,-437.58 527.72,-437.58 527.72,-437.58"/>
<polygon fill="black" stroke="black" points="527.72,-434.08 517.72,-437.58 527.72,-441.08 527.72,-434.08"/>
<text xml:space="preserve" text-anchor="middle" x="630" y="-294.75" font-family="Comic Sans MS" font-size="10.00">load time</text>
</g>
<!-- int4_mem&#45;&gt;int4_perf -->
<g id="edge6" class="edge">
<title>int4_mem&#45;&gt;int4_perf</title>
<path fill="none" stroke="black" d="M836.5,-203.93C836.5,-244.4 836.5,-313 836.5,-313 836.5,-313 994.98,-313 994.98,-313"/>
<polygon fill="black" stroke="black" points="994.98,-316.5 1004.98,-313 994.98,-309.5 994.98,-316.5"/>
<text xml:space="preserve" text-anchor="middle" x="930.62" y="-305.75" font-family="Comic Sans MS" font-size="10.00">inference</text>
</g>
<!-- bandwidth -->
<g id="node10" class="node">
<title>bandwidth</title>
<path fill="#b0e0e6" stroke="black" d="M1315.75,-203.75C1315.75,-203.75 1214.25,-203.75 1214.25,-203.75 1208.25,-203.75 1202.25,-197.75 1202.25,-191.75 1202.25,-191.75 1202.25,-158.25 1202.25,-158.25 1202.25,-152.25 1208.25,-146.25 1214.25,-146.25 1214.25,-146.25 1315.75,-146.25 1315.75,-146.25 1321.75,-146.25 1327.75,-152.25 1327.75,-158.25 1327.75,-158.25 1327.75,-191.75 1327.75,-191.75 1327.75,-197.75 1321.75,-203.75 1315.75,-203.75"/>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-189.3" font-family="Comic Sans MS" font-size="11.00">Memory Bandwidth</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-172.8" font-family="Comic Sans MS" font-size="11.00">4× less DRAM traffic</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-156.3" font-family="Comic Sans MS" font-size="11.00">Fits in L2/L3 cache</text>
</g>
<!-- int4_mem&#45;&gt;bandwidth -->
<g id="edge7" class="edge">
<title>int4_mem&#45;&gt;bandwidth</title>
<path fill="none" stroke="green" d="M840.05,-175C840.05,-175 1190.55,-175 1190.55,-175"/>
<polygon fill="green" stroke="green" points="1190.55,-178.5 1200.55,-175 1190.55,-171.5 1190.55,-178.5"/>
</g>
<!-- battery -->
<g id="node11" class="node">
<title>battery</title>
<path fill="#b0e0e6" stroke="black" d="M1310.12,-73.75C1310.12,-73.75 1219.88,-73.75 1219.88,-73.75 1213.88,-73.75 1207.88,-67.75 1207.88,-61.75 1207.88,-61.75 1207.88,-28.25 1207.88,-28.25 1207.88,-22.25 1213.88,-16.25 1219.88,-16.25 1219.88,-16.25 1310.12,-16.25 1310.12,-16.25 1316.12,-16.25 1322.12,-22.25 1322.12,-28.25 1322.12,-28.25 1322.12,-61.75 1322.12,-61.75 1322.12,-67.75 1316.12,-73.75 1310.12,-73.75"/>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-59.3" font-family="Comic Sans MS" font-size="11.00">Power Efficiency</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-42.8" font-family="Comic Sans MS" font-size="11.00">Less DRAM access</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-26.3" font-family="Comic Sans MS" font-size="11.00">Lower thermal load</text>
</g>
<!-- int4_mem&#45;&gt;battery -->
<g id="edge8" class="edge">
<title>int4_mem&#45;&gt;battery</title>
<path fill="none" stroke="green" d="M789.5,-145.83C789.5,-107.5 789.5,-45 789.5,-45 789.5,-45 1196.13,-45 1196.13,-45"/>
<polygon fill="green" stroke="green" points="1196.13,-48.5 1206.13,-45 1196.13,-41.5 1196.13,-48.5"/>
</g>
<!-- latency -->
<g id="node12" class="node">
<title>latency</title>
<path fill="#b0e0e6" stroke="black" d="M1316.5,-333.75C1316.5,-333.75 1213.5,-333.75 1213.5,-333.75 1207.5,-333.75 1201.5,-327.75 1201.5,-321.75 1201.5,-321.75 1201.5,-288.25 1201.5,-288.25 1201.5,-282.25 1207.5,-276.25 1213.5,-276.25 1213.5,-276.25 1316.5,-276.25 1316.5,-276.25 1322.5,-276.25 1328.5,-282.25 1328.5,-288.25 1328.5,-288.25 1328.5,-321.75 1328.5,-321.75 1328.5,-327.75 1322.5,-333.75 1316.5,-333.75"/>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-319.3" font-family="Comic Sans MS" font-size="11.00">Lower Latency</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-302.8" font-family="Comic Sans MS" font-size="11.00">Faster weight loading</text>
<text xml:space="preserve" text-anchor="middle" x="1265" y="-286.3" font-family="Comic Sans MS" font-size="11.00">Better tok/s</text>
</g>
<!-- int4_perf&#45;&gt;latency -->
<g id="edge9" class="edge">
<title>int4_perf&#45;&gt;latency</title>
<path fill="none" stroke="green" d="M1092.95,-309C1092.95,-309 1189.81,-309 1189.81,-309"/>
<polygon fill="green" stroke="green" points="1189.81,-312.5 1199.81,-309 1189.81,-305.5 1189.81,-312.5"/>
</g>
<!-- lookup -->
<g id="node8" class="node">
<title>lookup</title>
<path fill="#fafad2" stroke="black" d="M842.5,-551.5C842.5,-551.5 735.75,-551.5 735.75,-551.5 729.75,-551.5 723.75,-545.5 723.75,-539.5 723.75,-539.5 723.75,-522.5 723.75,-522.5 723.75,-516.5 729.75,-510.5 735.75,-510.5 735.75,-510.5 842.5,-510.5 842.5,-510.5 848.5,-510.5 854.5,-516.5 854.5,-522.5 854.5,-522.5 854.5,-539.5 854.5,-539.5 854.5,-545.5 848.5,-551.5 842.5,-551.5"/>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-537.05" font-family="Comic Sans MS" font-size="11.00">Dequant lookup tables</text>
<text xml:space="preserve" text-anchor="middle" x="789.12" y="-520.55" font-family="Comic Sans MS" font-size="11.00">Stored with model</text>
</g>
<!-- scale&#45;&gt;lookup -->
<g id="edge2" class="edge">
<title>scale&#45;&gt;lookup</title>
<path fill="none" stroke="black" d="M536.49,-540C536.49,-540 711.89,-540 711.89,-540"/>
<polygon fill="black" stroke="black" points="711.89,-543.5 721.89,-540 711.89,-536.5 711.89,-543.5"/>
</g>
<!-- lookup&#45;&gt;int4_model -->
<g id="edge3" class="edge">
<title>lookup&#45;&gt;int4_model</title>
<path fill="none" stroke="black" d="M803.5,-510.1C803.5,-510.1 803.5,-362.01 803.5,-362.01"/>
<polygon fill="black" stroke="black" points="807,-362.01 803.5,-352.01 800,-362.01 807,-362.01"/>
</g>
<!-- runtime&#45;&gt;int4_mem -->
<g id="edge5" class="edge">
<title>runtime&#45;&gt;int4_mem</title>
<path fill="none" stroke="black" d="M516.49,-418.42C604.35,-418.42 741.5,-418.42 741.5,-418.42 741.5,-418.42 741.5,-215.39 741.5,-215.39"/>
<polygon fill="black" stroke="black" points="745,-215.39 741.5,-205.39 738,-215.39 745,-215.39"/>
<text xml:space="preserve" text-anchor="middle" x="630" y="-191.75" font-family="Comic Sans MS" font-size="10.00">minimal overhead</text>
</g>
</g>
</svg>
