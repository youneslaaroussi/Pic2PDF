<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.1 (20251006.0113)
 -->
<!-- Pages: 1 -->
<svg width="2254pt" height="240pt"
 viewBox="0.00 0.00 2254.00 240.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 236)">
<polygon fill="white" stroke="none" points="-4,4 -4,-236 2250,-236 2250,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_vision</title>
<path fill="#fff8dc" stroke="black" d="M171.5,-14C171.5,-14 579.25,-14 579.25,-14 585.25,-14 591.25,-20 591.25,-26 591.25,-26 591.25,-117 591.25,-117 591.25,-123 585.25,-129 579.25,-129 579.25,-129 171.5,-129 171.5,-129 165.5,-129 159.5,-123 159.5,-117 159.5,-117 159.5,-26 159.5,-26 159.5,-20 165.5,-14 171.5,-14"/>
<text xml:space="preserve" text-anchor="middle" x="375.38" y="-113.6" font-family="Comic Sans MS" font-size="12.00">Vision Processing (TFLite)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_adapter</title>
<path fill="#e6f3ff" stroke="black" d="M746.75,-14C746.75,-14 1158.25,-14 1158.25,-14 1164.25,-14 1170.25,-20 1170.25,-26 1170.25,-26 1170.25,-117 1170.25,-117 1170.25,-123 1164.25,-129 1158.25,-129 1158.25,-129 746.75,-129 746.75,-129 740.75,-129 734.75,-123 734.75,-117 734.75,-117 734.75,-26 734.75,-26 734.75,-20 740.75,-14 746.75,-14"/>
<text xml:space="preserve" text-anchor="middle" x="952.5" y="-113.6" font-family="Comic Sans MS" font-size="12.00">Vision&#45;Language Adapter</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_llm</title>
<path fill="#ffe6f0" stroke="black" d="M1350.5,-8C1350.5,-8 1985.5,-8 1985.5,-8 1991.5,-8 1997.5,-14 1997.5,-20 1997.5,-20 1997.5,-212 1997.5,-212 1997.5,-218 1991.5,-224 1985.5,-224 1985.5,-224 1350.5,-224 1350.5,-224 1344.5,-224 1338.5,-218 1338.5,-212 1338.5,-212 1338.5,-20 1338.5,-20 1338.5,-14 1344.5,-8 1350.5,-8"/>
<text xml:space="preserve" text-anchor="middle" x="1668" y="-208.6" font-family="Comic Sans MS" font-size="12.00">Gemma 3N LLM (Autoregressive)</text>
</g>
<!-- img_in -->
<g id="node1" class="node">
<title>img_in</title>
<path fill="lightgreen" stroke="black" d="M68.5,-79.5C68.5,-79.5 12,-79.5 12,-79.5 6,-79.5 0,-73.5 0,-67.5 0,-67.5 0,-50.5 0,-50.5 0,-44.5 6,-38.5 12,-38.5 12,-38.5 68.5,-38.5 68.5,-38.5 74.5,-38.5 80.5,-44.5 80.5,-50.5 80.5,-50.5 80.5,-67.5 80.5,-67.5 80.5,-73.5 74.5,-79.5 68.5,-79.5"/>
<text xml:space="preserve" text-anchor="middle" x="40.25" y="-65.05" font-family="Comic Sans MS" font-size="11.00">Input Image</text>
<text xml:space="preserve" text-anchor="middle" x="40.25" y="-48.55" font-family="Comic Sans MS" font-size="11.00">224×224×3</text>
</g>
<!-- encoder -->
<g id="node2" class="node">
<title>encoder</title>
<path fill="#fafad2" stroke="black" d="M254.75,-96C254.75,-96 179.5,-96 179.5,-96 173.5,-96 167.5,-90 167.5,-84 167.5,-84 167.5,-34 167.5,-34 167.5,-28 173.5,-22 179.5,-22 179.5,-22 254.75,-22 254.75,-22 260.75,-22 266.75,-28 266.75,-34 266.75,-34 266.75,-84 266.75,-84 266.75,-90 260.75,-96 254.75,-96"/>
<text xml:space="preserve" text-anchor="middle" x="217.12" y="-81.55" font-family="Comic Sans MS" font-size="11.00">SigLIP Encoder</text>
<text xml:space="preserve" text-anchor="middle" x="217.12" y="-65.05" font-family="Comic Sans MS" font-size="11.00">12 layers</text>
<text xml:space="preserve" text-anchor="middle" x="217.12" y="-48.55" font-family="Comic Sans MS" font-size="11.00">INT4 quantized</text>
<text xml:space="preserve" text-anchor="middle" x="217.12" y="-32.05" font-family="Comic Sans MS" font-size="11.00">~150ms</text>
</g>
<!-- img_in&#45;&gt;encoder -->
<g id="edge1" class="edge">
<title>img_in&#45;&gt;encoder</title>
<path fill="none" stroke="black" d="M80.83,-59C80.83,-59 155.75,-59 155.75,-59"/>
<polygon fill="black" stroke="black" points="155.75,-62.5 165.75,-59 155.75,-55.5 155.75,-62.5"/>
</g>
<!-- pool -->
<g id="node3" class="node">
<title>pool</title>
<path fill="#fafad2" stroke="black" d="M571.25,-85.5C571.25,-85.5 447.25,-85.5 447.25,-85.5 441.25,-85.5 435.25,-79.5 435.25,-73.5 435.25,-73.5 435.25,-56.5 435.25,-56.5 435.25,-50.5 441.25,-44.5 447.25,-44.5 447.25,-44.5 571.25,-44.5 571.25,-44.5 577.25,-44.5 583.25,-50.5 583.25,-56.5 583.25,-56.5 583.25,-73.5 583.25,-73.5 583.25,-79.5 577.25,-85.5 571.25,-85.5"/>
<text xml:space="preserve" text-anchor="middle" x="509.25" y="-71.05" font-family="Comic Sans MS" font-size="11.00">Attention Pooling</text>
<text xml:space="preserve" text-anchor="middle" x="509.25" y="-54.55" font-family="Comic Sans MS" font-size="11.00">256 patches → 64 tokens</text>
</g>
<!-- encoder&#45;&gt;pool -->
<g id="edge2" class="edge">
<title>encoder&#45;&gt;pool</title>
<path fill="none" stroke="black" d="M267.01,-65C267.01,-65 423.38,-65 423.38,-65"/>
<polygon fill="black" stroke="black" points="423.38,-68.5 433.38,-65 423.38,-61.5 423.38,-68.5"/>
<text xml:space="preserve" text-anchor="middle" x="351" y="-69.75" font-family="Comic Sans MS" font-size="10.00">[768] embeddings</text>
</g>
<!-- cross_attn -->
<g id="node4" class="node">
<title>cross_attn</title>
<path fill="#b0e0e6" stroke="black" d="M856.25,-93.75C856.25,-93.75 754.75,-93.75 754.75,-93.75 748.75,-93.75 742.75,-87.75 742.75,-81.75 742.75,-81.75 742.75,-48.25 742.75,-48.25 742.75,-42.25 748.75,-36.25 754.75,-36.25 754.75,-36.25 856.25,-36.25 856.25,-36.25 862.25,-36.25 868.25,-42.25 868.25,-48.25 868.25,-48.25 868.25,-81.75 868.25,-81.75 868.25,-87.75 862.25,-93.75 856.25,-93.75"/>
<text xml:space="preserve" text-anchor="middle" x="805.5" y="-79.3" font-family="Comic Sans MS" font-size="11.00">Cross&#45;Attention</text>
<text xml:space="preserve" text-anchor="middle" x="805.5" y="-62.8" font-family="Comic Sans MS" font-size="11.00">768&#45;dim → 2048&#45;dim</text>
<text xml:space="preserve" text-anchor="middle" x="805.5" y="-46.3" font-family="Comic Sans MS" font-size="11.00">Linear projection</text>
</g>
<!-- pool&#45;&gt;cross_attn -->
<g id="edge3" class="edge">
<title>pool&#45;&gt;cross_attn</title>
<path fill="none" stroke="black" d="M583.62,-65C583.62,-65 731.11,-65 731.11,-65"/>
<polygon fill="black" stroke="black" points="731.11,-68.5 741.11,-65 731.11,-61.5 731.11,-68.5"/>
<text xml:space="preserve" text-anchor="middle" x="663" y="-69.75" font-family="Comic Sans MS" font-size="10.00">64 vision tokens</text>
</g>
<!-- prefix -->
<g id="node5" class="node">
<title>prefix</title>
<path fill="#b0e0e6" stroke="black" d="M1150.25,-96C1150.25,-96 1066,-96 1066,-96 1060,-96 1054,-90 1054,-84 1054,-84 1054,-34 1054,-34 1054,-28 1060,-22 1066,-22 1066,-22 1150.25,-22 1150.25,-22 1156.25,-22 1162.25,-28 1162.25,-34 1162.25,-34 1162.25,-84 1162.25,-84 1162.25,-90 1156.25,-96 1150.25,-96"/>
<text xml:space="preserve" text-anchor="middle" x="1108.12" y="-81.55" font-family="Comic Sans MS" font-size="11.00">Multimodal Prefix</text>
<text xml:space="preserve" text-anchor="middle" x="1108.12" y="-65.05" font-family="Comic Sans MS" font-size="11.00">64 vision tokens</text>
<text xml:space="preserve" text-anchor="middle" x="1108.12" y="-48.55" font-family="Comic Sans MS" font-size="11.00">+</text>
<text xml:space="preserve" text-anchor="middle" x="1108.12" y="-32.05" font-family="Comic Sans MS" font-size="11.00">32 prompt tokens</text>
</g>
<!-- cross_attn&#45;&gt;prefix -->
<g id="edge4" class="edge">
<title>cross_attn&#45;&gt;prefix</title>
<path fill="none" stroke="black" d="M868.57,-65C868.57,-65 1042.24,-65 1042.24,-65"/>
<polygon fill="black" stroke="black" points="1042.24,-68.5 1052.24,-65 1042.24,-61.5 1042.24,-68.5"/>
<text xml:space="preserve" text-anchor="middle" x="961.12" y="-69.75" font-family="Comic Sans MS" font-size="10.00">projected to LLM dim</text>
</g>
<!-- embed -->
<g id="node6" class="node">
<title>embed</title>
<path fill="#ffb6c1" stroke="black" d="M1441.25,-79.5C1441.25,-79.5 1358.5,-79.5 1358.5,-79.5 1352.5,-79.5 1346.5,-73.5 1346.5,-67.5 1346.5,-67.5 1346.5,-50.5 1346.5,-50.5 1346.5,-44.5 1352.5,-38.5 1358.5,-38.5 1358.5,-38.5 1441.25,-38.5 1441.25,-38.5 1447.25,-38.5 1453.25,-44.5 1453.25,-50.5 1453.25,-50.5 1453.25,-67.5 1453.25,-67.5 1453.25,-73.5 1447.25,-79.5 1441.25,-79.5"/>
<text xml:space="preserve" text-anchor="middle" x="1399.88" y="-65.05" font-family="Comic Sans MS" font-size="11.00">Token Embedding</text>
<text xml:space="preserve" text-anchor="middle" x="1399.88" y="-48.55" font-family="Comic Sans MS" font-size="11.00">2048&#45;dim</text>
</g>
<!-- prefix&#45;&gt;embed -->
<g id="edge5" class="edge">
<title>prefix&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M1162.66,-59C1162.66,-59 1334.59,-59 1334.59,-59"/>
<polygon fill="black" stroke="black" points="1334.59,-62.5 1344.59,-59 1334.59,-55.5 1334.59,-62.5"/>
<text xml:space="preserve" text-anchor="middle" x="1254.38" y="-63.75" font-family="Comic Sans MS" font-size="10.00">96 multimodal tokens</text>
</g>
<!-- transformer -->
<g id="node7" class="node">
<title>transformer</title>
<path fill="#ffb6c1" stroke="black" d="M1704.5,-90C1704.5,-90 1612.75,-90 1612.75,-90 1606.75,-90 1600.75,-84 1600.75,-78 1600.75,-78 1600.75,-28 1600.75,-28 1600.75,-22 1606.75,-16 1612.75,-16 1612.75,-16 1704.5,-16 1704.5,-16 1710.5,-16 1716.5,-22 1716.5,-28 1716.5,-28 1716.5,-78 1716.5,-78 1716.5,-84 1710.5,-90 1704.5,-90"/>
<text xml:space="preserve" text-anchor="middle" x="1658.62" y="-75.55" font-family="Comic Sans MS" font-size="11.00">Transformer Stack</text>
<text xml:space="preserve" text-anchor="middle" x="1658.62" y="-59.05" font-family="Comic Sans MS" font-size="11.00">18 layers (2B)</text>
<text xml:space="preserve" text-anchor="middle" x="1658.62" y="-42.55" font-family="Comic Sans MS" font-size="11.00">26 layers (4B)</text>
<text xml:space="preserve" text-anchor="middle" x="1658.62" y="-26.05" font-family="Comic Sans MS" font-size="11.00">MQA, RoPE</text>
</g>
<!-- embed&#45;&gt;transformer -->
<g id="edge6" class="edge">
<title>embed&#45;&gt;transformer</title>
<path fill="none" stroke="black" d="M1453.49,-59C1453.49,-59 1589.07,-59 1589.07,-59"/>
<polygon fill="black" stroke="black" points="1589.07,-62.5 1599.07,-59 1589.07,-55.5 1589.07,-62.5"/>
<text xml:space="preserve" text-anchor="middle" x="1527" y="-63.75" font-family="Comic Sans MS" font-size="10.00">[B, 96, 2048]</text>
</g>
<!-- lm_head -->
<g id="node8" class="node">
<title>lm_head</title>
<path fill="#ffb6c1" stroke="black" d="M1977.5,-87.75C1977.5,-87.75 1877.5,-87.75 1877.5,-87.75 1871.5,-87.75 1865.5,-81.75 1865.5,-75.75 1865.5,-75.75 1865.5,-42.25 1865.5,-42.25 1865.5,-36.25 1871.5,-30.25 1877.5,-30.25 1877.5,-30.25 1977.5,-30.25 1977.5,-30.25 1983.5,-30.25 1989.5,-36.25 1989.5,-42.25 1989.5,-42.25 1989.5,-75.75 1989.5,-75.75 1989.5,-81.75 1983.5,-87.75 1977.5,-87.75"/>
<text xml:space="preserve" text-anchor="middle" x="1927.5" y="-73.3" font-family="Comic Sans MS" font-size="11.00">LM Head</text>
<text xml:space="preserve" text-anchor="middle" x="1927.5" y="-56.8" font-family="Comic Sans MS" font-size="11.00">Softmax → token_id</text>
<text xml:space="preserve" text-anchor="middle" x="1927.5" y="-40.3" font-family="Comic Sans MS" font-size="11.00">~256k vocab</text>
</g>
<!-- transformer&#45;&gt;lm_head -->
<g id="edge7" class="edge">
<title>transformer&#45;&gt;lm_head</title>
<path fill="none" stroke="black" d="M1716.97,-59C1716.97,-59 1853.54,-59 1853.54,-59"/>
<polygon fill="black" stroke="black" points="1853.54,-62.5 1863.54,-59 1853.54,-55.5 1853.54,-62.5"/>
<text xml:space="preserve" text-anchor="middle" x="1791" y="-63.75" font-family="Comic Sans MS" font-size="10.00">hidden states</text>
</g>
<!-- lm_head&#45;&gt;embed -->
<g id="edge9" class="edge">
<title>lm_head&#45;&gt;embed</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1927,-88.11C1927,-101.3 1927,-114 1927,-114 1927,-114 1400,-114 1400,-114 1400,-114 1400,-91.31 1400,-91.31"/>
<polygon fill="blue" stroke="blue" points="1403.5,-91.31 1400,-81.31 1396.5,-91.31 1403.5,-91.31"/>
<text xml:space="preserve" text-anchor="middle" x="1658.62" y="-180.75" font-family="Comic Sans MS" font-size="10.00">next token</text>
</g>
<!-- latex_out -->
<g id="node9" class="node">
<title>latex_out</title>
<path fill="lightgreen" stroke="black" d="M2234,-87.75C2234,-87.75 2154.25,-87.75 2154.25,-87.75 2148.25,-87.75 2142.25,-81.75 2142.25,-75.75 2142.25,-75.75 2142.25,-42.25 2142.25,-42.25 2142.25,-36.25 2148.25,-30.25 2154.25,-30.25 2154.25,-30.25 2234,-30.25 2234,-30.25 2240,-30.25 2246,-36.25 2246,-42.25 2246,-42.25 2246,-75.75 2246,-75.75 2246,-81.75 2240,-87.75 2234,-87.75"/>
<text xml:space="preserve" text-anchor="middle" x="2194.12" y="-73.3" font-family="Comic Sans MS" font-size="11.00">LaTeX Output</text>
<text xml:space="preserve" text-anchor="middle" x="2194.12" y="-56.8" font-family="Comic Sans MS" font-size="11.00">~100&#45;500 tokens</text>
<text xml:space="preserve" text-anchor="middle" x="2194.12" y="-40.3" font-family="Comic Sans MS" font-size="11.00">2&#45;8s total</text>
</g>
<!-- lm_head&#45;&gt;latex_out -->
<g id="edge8" class="edge">
<title>lm_head&#45;&gt;latex_out</title>
<path fill="none" stroke="black" d="M1989.68,-59C1989.68,-59 2130.66,-59 2130.66,-59"/>
<polygon fill="black" stroke="black" points="2130.66,-62.5 2140.66,-59 2130.66,-55.5 2130.66,-62.5"/>
<text xml:space="preserve" text-anchor="middle" x="2065.88" y="-78" font-family="Comic Sans MS" font-size="10.00">autoregressive</text>
<text xml:space="preserve" text-anchor="middle" x="2065.88" y="-63.75" font-family="Comic Sans MS" font-size="10.00">~50 tok/s</text>
</g>
</g>
</svg>
